<div class="table-responsive" *ngIf="data">
  <table mat-table [dataSource]="data" style="width: auto; overflow-x: scroll">
    <ng-container matColumnDef="serial">
      <th mat-header-cell *matHeaderCellDef>Claim Number</th>
      <td
        mat-cell
        *matCellDef="let element"
        class="light-blue-700"
        style="cursor: pointer"
        (click)="_url.navigateTo('portal/claims', element.serial)">
        #{{ element.serial | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="creation_date">
      <th mat-header-cell *matHeaderCellDef>Claim Date</th>
      <td mat-cell *matCellDef="let element">
        Created: {{ element.createdAt | date | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="policy_number">
      <th mat-header-cell *matHeaderCellDef>Policy Number</th>
      <td
        mat-cell
        *matCellDef="let element"
        class="light-blue-700"
        style="cursor: pointer"
        (click)="_url.navigateTo('portal/policies', element.serial)">
        {{ element.policy.policy_number | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="account">
      <th mat-header-cell *matHeaderCellDef>Account</th>
      <td
        mat-cell
        *matCellDef="let element"
        class="light-blue-700"
        style="cursor: pointer"
        (click)="_url.navigateTo('portal/accounts', element.client_id)">
        {{ element.client.account_name | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="date_of_event">
      <th mat-header-cell *matHeaderCellDef>Event Date</th>
      <td mat-cell *matCellDef="let element">
        {{ element.event_date | date | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td
        mat-cell
        *matCellDef="let element"
        [ngClass]="getStatusClass(element.status)">
        {{ element.status | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="amount">
      <th mat-header-cell *matHeaderCellDef>Amount</th>
      <td mat-cell *matCellDef="let element">
        {{ element.amount_requested | currency | notNull }}
      </td>
    </ng-container>

    <ng-container matColumnDef="created_by">
      <th mat-header-cell *matHeaderCellDef>Created By</th>
      <td
        mat-cell
        *matCellDef="let element"
        class="light-blue-700"
        style="cursor: pointer"
        (click)="_url.navigateTo('portal/users', element.broker.user_id)">
        {{
          element.broker.user.first_name + ' ' + element.broker.user.last_name
            | notNull
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="actions" stickyEnd>
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let element">
        <div class="d-flex align-items-center">
          <ng-container *ngFor="let action of element.actions">
            <span
              class="material-icons-outlined me-2"
              style="cursor: pointer; display: inline-block"
              [ngClass]="action.colorClass"
              matTooltip="{{ action.tooltip }}"
              (click)="changeStatus(element._id, action.newStatus)">
              {{ action.icon }}
            </span>
          </ng-container>

          <span
            class="material-icons-outlined me-2"
            style="cursor: pointer; display: inline-block"
            matTooltip="Edit this claim"
            (click)="_url.navigateTo('portal/claims', element.serial, 'edit')">
            edit
          </span>

          <span
            class="material-icons-outlined text-danger me-2"
            style="cursor: pointer; display: inline-block"
            matTooltip="Delete this claim"
            (click)="deleteClaim(element._id)">
            delete
          </span>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr *matNoDataRow>
      <td colspan="9">
        <app-default-empty-state
          [url]="'portal/claims/new'"
          *ngIf="!filtersActive.length"></app-default-empty-state>
        <app-filter-empty-state
          *ngIf="filtersActive.length"></app-filter-empty-state>
      </td>
    </tr>
    <tr
      mat-row
      *matRowDef="let row; columns: displayedColumns"
      class="mas-table-row"></tr>
  </table>
</div>
